// ==SE_module==
// name: get_conversation_id
// displayName: Get Conversation ID by Username
// description: يستخرج Conversation ID لمحادثة قديمة بناءً على اليوزرنيم
// version: 1.0
// author: YourName
// ==/SE_module==

module.onSnapEnhanceLoad = (context) => {
    try {
        const dbHelper = Java.use("com.snapchat.android.persistence.DatabaseHelper");
        const db = dbHelper.getDatabase();  // SQLiteDatabase object

        // بدّل "oldfriend123" باليوزرنيم اللي بدك تبحث عنه
        const username = "oldfriend123";
        const query = "SELECT conversation_id FROM conversations WHERE participant_id = ?";
        const cursor = db.rawQuery(query, [username]);

        if (cursor.moveToFirst()) {
            const convId = cursor.getString(0);
            longToast("✅ Conversation ID: " + convId);
        } else {
            longToast("❌ ما لقيت محادثة لهاليوزر: " + username);
        }
        cursor.close();
    } catch (err) {
        longToast("خطأ أثناء البحث: " + err);
    }
};
